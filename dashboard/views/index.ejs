<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Dashboard Bot</title>
  <link rel="stylesheet" href="/public/style.css"/>
</head>
<body>
<header>
  <h1>Bot Dashboard</h1>
  <nav>
    <% if (user) { %>
      <span>Connecté en tant que <strong><%= user.username %></strong></span>
      <a href="/dashboard">Mes serveurs</a>
      <a href="/logout">Se déconnecter</a>
    <% } else { %>
      <a class="btn" href="/login">Se connecter avec Discord</a>
    <% } %>
  </nav>
</header>

<main>
  <h2>Mes serveurs</h2>

  <% if (!user) { %>
    <p>Connecte-toi pour voir tes serveurs.</p>
  <% } else if (!guilds || guilds.length === 0) { %>
    <p>Aucun serveur géré trouvé. Vérifie que tu as la permission <code>Gérer le serveur</code>.</p>
  <% } else { %>
    <ul class="guilds">
      <% guilds.forEach(g => { %>
        <li>
          <a class="card" href="/guild/<%= g.id %>">
            <div class="icon" style="background:#5865F2">
              <%= (g.icon ? '' : g.name[0].toUpperCase()) %>
            </div>
            <div class="meta">
              <strong><%= g.name %></strong>
              <code><%= g.id %></code>
            </div>
          </a>
        </li>
      <% }) %>
    </ul>
  <% } %>
</main>

<footer>
  <small>© <%= new Date().getFullYear() %> – Ton Bot</small>
</footer>
</body>
</html>
