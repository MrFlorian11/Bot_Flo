<% layout('layout') -%>

<h2>Configuration – Guilde <code><%= guildId %></code></h2>

<% if (typeof query !== 'undefined' && query.saved) { %>
  <p class="notice success">✅ Sauvegardé.</p>
<% } %>

<form method="post" action="/guild/<%= guildId %>">
  <section class="card">
    <h3>Salon de logs</h3>
    <p>
      <label for="channelId">ID du salon :</label>
      <input type="text" id="channelId" name="channelId" value="<%= cfg.channelId || '' %>" placeholder="ex: 123456789012345678" />
    </p>
    <p class="hint">
      Astuce : fais clic-droit sur un salon (mode développeur Discord activé) → Copier l’identifiant.
    </p>
  </section>

  <section class="card">
    <h3>Catégories</h3>
    <div class="grid">
      <% cats.forEach(([key, label]) => { %>
        <label class="toggle">
          <input type="checkbox" name="cat_<%= key %>" <%= cfg.categories[key] !== false ? 'checked' : '' %> />
          <span><%= label %></span>
        </label>
      <% }) %>
    </div>
  </section>

  <p>
    <button class="btn primary" type="submit">💾 Enregistrer</button>
    <a class="btn" href="/dashboard">← Retour</a>
  </p>
</form>

<section class="card">
  <h3>Tester</h3>
  <p>Utilise la commande <code>/logs test</code> dans Discord pour envoyer un message de test dans le salon configuré.</p>
</section>
